import random
from mesa import Agent

class PatchAgent(Agent):
    def __init__(self, unique_id, model, pos):
        super().__init__(unique_id, model)
        self.pos = pos  # Posição na grid
        self.state = "forested"  # Outros estados: "burning", "burned"
        self.pcolor = 55  # Valor inicial que mapeia para "verde"

    def step(self):
        if self.state == "forested":
            # Se algum vizinho estiver em fogo, há chance de pegar fogo
            neighbors = self.model.grid.get_neighbors(self.pos, moore=False)
            if any(neighbor.state == "burning" for neighbor in neighbors):
                if random.random() < 0.3:
                    self.state = "burning"
                    self.pcolor = 25  # Valor para fogo (laranja)
        elif self.state == "burning":
            # Passa a estado queimado
            self.state = "burned"
            self.pcolor = 5  # Valor para queimado (ex.: cinzento)
